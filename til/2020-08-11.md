```
# Default to the root user but allow overriding the docker user and group ID
  && apt-get install --assume-yes sudo	# with ARG variables. Typically these will be set to $(id -u) to match the host
# user with a docker build flags like:
#
#    --build-arg USER_ID="$(id -u)" \
#    --build-arg GROUP_ID="$(id -g)" \
#    --build-arg USER_NAME="user" \
#
# This means files created in Docker aren't owned by root which is annoying
# with bind mounts.
# https://stackoverflow.com/a/48329093/30900
ARG USER_ID=0
ARG GROUP_ID=0
ARG USER_NAME=root
RUN set -eux; \
  if [ $USER_ID != 0 ]; then \
    addgroup --gid $GROUP_ID $USER_NAME; \
    adduser --disabled-password --gecos '' --uid $USER_ID --gid $GROUP_ID $USER_NAME; \
    adduser $USER_NAME sudo; \
    echo '%sudo ALL=(ALL) NOPASSWD:ALL' >> /etc/sudoers; \
  fi;

USER $USER_NAME
```